<!doctype html>

<html lang="en">

<head>

<meta charset="utf-8" />

<meta name="viewport" content="width=device-width,initial-scale=1" />

<title>Simple Draw Canvas</title>

<style>

  :root{--ui-bg:#0f1724;--panel:#0b1220;--accent:#06b6d4;--muted:#94a3b8}

  html,body{height:100%;margin:0;background:linear-gradient(180deg,#071022,#07101a);}

  .app{height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:14px;padding:18px;box-sizing:border-box}

  .controls{display:flex;gap:10px;align-items:center;background:rgba(255,255,255,0.03);padding:10px;border-radius:10px;backdrop-filter:blur(6px);box-shadow:0 6px 18px rgba(2,6,23,0.6)}

  .controls label{font-family:system-ui,-apple-system,Segoe UI,Roboto; color:var(--muted);font-size:13px}

  .btn{background:linear-gradient(90deg,#0ea5a4,#7c3aed);color:white;padding:8px 12px;border-radius:8px;border:0;cursor:pointer;font-weight:600}

  .btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06)}

  .panel{width:90vw;max-width:1200px;height:calc(90vw / 6);max-height:200px;border-radius:12px;overflow:hidden;position:relative;box-shadow:0 18px 50px rgba(2,6,23,0.7)}

  canvas{display:block;width:100%;height:100%;background:#ffffff;cursor:crosshair}

  .legend{position:absolute;left:12px;bottom:12px;padding:8px 10px;background:rgba(0,0,0,0.35);color:#e6eef6;border-radius:8px;font-family:system-ui;font-size:13px}

  .small{font-size:12px;color:var(--muted);margin-left:6px}
  .draw-label{font-family:system-ui;color:var(--muted);font-size:14px;font-weight:500;margin-bottom:8px}

  input[type=range]{accent-color:var(--accent)}

  @media (max-width:700px){ .controls{flex-wrap:wrap;justify-content:center} .panel{max-width:900px;height:calc(900px / 6)} }

</style>

</head>

<body>

  <div class="app">

    <div class="controls" role="toolbar" aria-label="Drawing controls">

      <label>Color <input id="color" type="color" value="#06b6d4" style="margin-left:8px"></label>

      <label style="margin-left:8px">Size <input id="size" type="range" min="1" max="80" value="6" style="vertical-align:middle;margin-left:8px"></label>

      <button id="eraser" class="btn ghost">Eraser</button>

      <button id="clear" class="btn ghost">Clear</button>

      <button id="save" class="btn">Save PNG</button>

      <div class="small" style="margin-left:10px">Tip: draw with mouse or touch</div>

    </div>

    
    <div class="draw-label">DRAW HERE</div>

    <div class="panel" id="panel">

      <canvas id="canvas"></canvas>

      <div class="legend">Free Draw â€¢ <span id="mode">Draw</span></div>

    </div>

  </div>



<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
import { getDatabase, ref, onChildAdded, push, set, remove } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-database.js";

// ðŸ”¥ Your Firebase config
const firebaseConfig = {
    apiKey: "AIzaSyBFc597khPRThMIGF4BRkqA7VxnNEM0zFk",
    authDomain: "shared-drawing-canvas.firebaseapp.com",
    databaseURL: "https://shared-drawing-canvas-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "shared-drawing-canvas",
    storageBucket: "shared-drawing-canvas.firebasestorage.app",
    messagingSenderId: "379615731075",
    appId: "1:379615731075:web:113fea60f358360975aab6"
  };

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);
const drawRef = ref(db, "drawings");

const canvas = document.getElementById('canvas');
const panel = document.getElementById('panel');
const ctx = canvas.getContext('2d');
const colorInput = document.getElementById('color');
const sizeInput = document.getElementById('size');
const clearBtn = document.getElementById('clear');
const eraserBtn = document.getElementById('eraser');
const modeEl = document.getElementById('mode');

let drawing = false, last = {x:0,y:0}, isEraser = false;

function resize(){
  const ratio = window.devicePixelRatio || 1;
  const rect = panel.getBoundingClientRect();
  canvas.width = rect.width * ratio;
  canvas.height = rect.height * ratio;
  ctx.scale(ratio, ratio);
  ctx.lineCap = "round";
  ctx.lineJoin = "round";
  ctx.fillStyle = "#fff";
  ctx.fillRect(0,0,canvas.width,canvas.height);
}
resize();

function getPos(e){
  const rect = canvas.getBoundingClientRect();
  const t = e.touches ? e.touches[0] : e;
  return {x: t.clientX - rect.left, y: t.clientY - rect.top};
}

function drawLine(data){
  ctx.lineWidth = data.size;
  ctx.strokeStyle = data.erase ? "rgba(0,0,0,1)" : data.color;
  ctx.globalCompositeOperation = data.erase ? "destination-out" : "source-over";
  ctx.beginPath();
  ctx.moveTo(data.from.x, data.from.y);
  ctx.lineTo(data.to.x, data.to.y);
  ctx.stroke();
}

function pointerDown(e){ e.preventDefault(); drawing = true; last = getPos(e); }
function pointerMove(e){
  if(!drawing) return;
  const pos = getPos(e);
  const line = {from:last, to:pos, color:colorInput.value, size:+sizeInput.value, erase:isEraser};
  drawLine(line);
  push(drawRef, line);
  last = pos;
}
function pointerUp(){ drawing = false; }

canvas.addEventListener("mousedown", pointerDown);
canvas.addEventListener("mousemove", pointerMove);
window.addEventListener("mouseup", pointerUp);
canvas.addEventListener("touchstart", pointerDown, {passive:false});
canvas.addEventListener("touchmove", pointerMove, {passive:false});
window.addEventListener("touchend", pointerUp);

eraserBtn.addEventListener("click", ()=>{
  isEraser = !isEraser;
  eraserBtn.textContent = isEraser ? "Drawing" : "Eraser";
  modeEl.textContent = isEraser ? "Eraser" : "Draw";
});

clearBtn.addEventListener("click", ()=> remove(drawRef));

onChildAdded(drawRef, (snapshot)=>{
  const data = snapshot.val();
  drawLine(data);
});
</script>

</body>

</html>
